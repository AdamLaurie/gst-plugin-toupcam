toupcamsrc
=======

What it is
----------

This is a source element for GStreamer 1.0 for live acquisition from a camera that uses the 
toupcam SDK (https://en.ids-imaging.com/downloads.html).

Comments
--------

 - It supports just colour of one type


McMaster WIP
--------

    # FOLLOW THIS SECTION
    # They are the best instructions right now

    # Ubuntu 20.04, tested on 2020-08-12
    # Linux dell 5.4.0-26-generic #30-Ubuntu SMP Mon Apr 20 16:58:30 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux
    # Note 1.8.3 tested working on reference laptop, but 1.16.2 on 20.04
    sudo apt-get install autoconf
    sudo apt-get install -y libtool
    sudo apt-get install -y dpkg-dev devscripts
    # Takes a while
    sudo apt-get install -y gstreamer1.0*
    sudo apt-get install -y libgstreamer-plugins-base1.0-dev
    # Is this actually needed?
    sudo apt-get install -y build-essential libgtk-3-dev

    cd ~
    # md5sum
    # ca5ca6e77f3913ce4a8dda3d4544dce3  toupcamsdk.zip
    unzip toupcamsdk.zip
    sudo mv toupcamsdk /opt/
    pushd /opt/toupcamsdk/
    sudo cp linux/udev/99-toupcam.rules  /etc/udev/rules.d/
    sudo cp linux/x64/libtoupcam.so /lib/x86_64-linux-gnu/
    popd

    cd ~
    git clone https://github.com/JohnDMcMaster/gst-plugin-toupcam.git
    cd gst-plugin-toupcam
    ./autogen.sh
    make
    GST_DEBUG=0 GST_PLUGIN_PATH=$PWD/src/.libs/ gst-inspect-1.0 toupcamsrc
    GST_DEBUG=0 GST_PLUGIN_PATH=$PWD/src/.libs/ gst-launch-1.0 toupcamsrc ! videoconvert ! xvimagesink


Building
--------

Building on linux is tested using the autogen script.
Tested with toupcamsdk Apr 2020 on Ubuntu 18.04 64 bit.

First run autogen.sh
	$ chmod a+x autogen.sh
	$ ./autogen.sh
This will use autotools to setup the dev environment, and complete with the line:
"Now type 'make' to compile this module."
You can do that.
	$ make

	$ sudo make install 
will put install the lo file for use with GStreamer, in /usr/local/lib/gstreamer-1.0
To use this in a pipeline you need to tell gstreamer where to find the .lo file.
use:
	$ export GST_PLUGIN_PATH=/usr/local/lib/gstreamer-1.0

See the INSTALL file for advanced setup.

To import into the Eclipse IDE, use "existing code as Makefile project", and the file EclipseSymbolsAndIncludePaths.xml is included here
to import the library locations into the project (Properties -> C/C++ General -> Paths and symbols).

Libraries
---------

Download and install the toupcam SDK.
Example install script:
	cd ~/Downloads/toupcamsdk/
	MACHINE_TYPE=`uname -m`
	if [ ${MACHINE_TYPE} == 'x86_64' ]; then
		echo x64
		sudo sh toupcamsdk
	else
		echo x86
		sudo sh toupcamsdk
	fi

The file src/Makefile.am contains pointers to where with toupcam includes and libraries are expected to be.
Headers: /usr/include
Libraries: /usr/lib

Example commands for installing the GStreamer development libraries on Ubuntu 18.04
        sudo add-apt-repository -y ppa:gstreamer-developers/ppa
	sudo apt-get update
	sudo apt-get install -y dpkg-dev devscripts
	sudo apt-get install -y gstreamer1.0*
	sudo apt-get install -y libgstreamer-plugins-base1.0-dev
	echo "export GST_PLUGIN_PATH=/usr/local/lib/gstreamer-1.0" >> ~/.profile
	sudo apt-get install -y build-essential libgtk-3-dev

toupcamsrc pipelines
--------------------

	gst-launch-1.0 toupcamsrc ! videoconvert ! xvimagesink
	gst-inspect-1.0 toupcamsrc

Locations
---------

Gstreamer plugin locations:
/usr/lib/i386-linux-gnu/gstreamer-1.0
/usr/local/lib/gstreamer-1.0

